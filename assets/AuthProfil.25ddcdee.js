import{R as E,r as i,O as S,S as H,U as W,V as o,W as L,an as O,a3 as s,X as l,_ as A,Y as d,a2 as h}from"./index.9dafe3c6.js";import{Q as T}from"./QInnerLoading.9562ce0c.js";import{Q as F}from"./QMarkupTable.36a1defc.js";import{b as C,Q as R,a as v}from"./QCard.c4fa545a.js";import{Q as $}from"./QDialog.4f4818b7.js";import{u as K}from"./use-meta.6e4b83a8.js";import{b as X,c as V,n as U}from"./function.626c708b.js";import{u as Y}from"./storage.58af7870.js";import"./use-form.473e5b63.js";import"./use-prevent-scroll.ab33211b.js";const j={class:"q-my-lg"},z=s("thead",null,[s("tr",null,[s("th",null,"Nama"),s("th",null,"NIP"),s("th",null,"RUH")])],-1),ie=E({__name:"AuthProfil",setup(G){K({title:"Admin",titleTemplate:t=>`${t} - e-Umum 155`,meta:{description:{name:"description",content:"Menu admin aplikasi e Umum 155"},keywords:{name:"keywords",content:"Aplikasi e Umum 155"}}});const k=X(),Q=L(),p=i(!1),f=Y(),m=i({}),r=i(!1),c=i(!0),b=i(!0),y=i(!0);function _(){p.value=!0,V.get("user").then(t=>{f.user=t.data,m.value=f.user,p.value=!1}).catch(t=>{U(t.response.data)})}function B(){V.get("waktu").then(()=>{}).catch(t=>{U(t.response.data),k.localStorage.remove("auth"),f.$reset(),Q.push("/")})}k.localStorage.getItem("auth")?(B(),f.user?m.value=f.user:_()):Q.push("/");const w=i(!1),u=S({current_password:null,password:null,password_confirmation:null});function x(){k.notify({progress:!0,message:"Berhasil mengubah",color:"green",icon:"check_circle",position:"top-right"})}function I(){r.value=!0,V.put("user/password",u).then(()=>{w.value=!1,p.value=!0,x(),q(),_(),r.value=!1}).catch(t=>{U(t.response.data),r.value=!1})}function q(){u.current_password=null,u.password=null,u.password_confirmation=null}const g=i(!1);function N(t){g.value=!0,n.name=t.name,n.email=t.email}const n=S({name:null,email:null});function D(){r.value=!0,V.put("user/profile-information",n).then(()=>{g.value=!1,p.value=!0,x(),P(),_(),r.value=!1}).catch(t=>{U(t.response.data),r.value=!1})}function P(){n.name=null,n.email=null}return(t,e)=>{const M=O("auth-layout");return H(),W(M,{title:"Edit Profil",user:m.value},{default:o(()=>[s("div",j,[l(F,null,{default:o(()=>[z,s("tbody",null,[s("tr",null,[s("td",null,A(m.value.name),1),s("td",null,A(m.value.NIP),1),s("td",null,[l(d,{class:"q-mr-sm",label:"UBAH PASSWORD",color:"primary",onClick:e[0]||(e[0]=a=>w.value=!0)}),l(d,{class:"q-ml-sm",label:"UBAH NAMA & EMAIL",color:"primary",onClick:e[1]||(e[1]=a=>N(m.value))})])])]),l(T,{showing:p.value},null,8,["showing"])]),_:1}),l($,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=a=>w.value=a)},{default:o(()=>[l(C,{class:"q-pa-md",style:{"max-width":"400px"}},{default:o(()=>[l(R,{onSubmit:I,onReset:q,class:"q-gutter-md"},{default:o(()=>[l(v,{filled:"",modelValue:u.current_password,"onUpdate:modelValue":e[3]||(e[3]=a=>u.current_password=a),type:c.value?"password":"text",label:"Password lama"},{append:o(()=>[l(h,{name:c.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[2]||(e[2]=a=>c.value=!c.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),l(v,{filled:"",modelValue:u.password,"onUpdate:modelValue":e[5]||(e[5]=a=>u.password=a),type:b.value?"password":"text",label:"Password baru"},{append:o(()=>[l(h,{name:b.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[4]||(e[4]=a=>b.value=!b.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),l(v,{filled:"",modelValue:u.password_confirmation,"onUpdate:modelValue":e[7]||(e[7]=a=>u.password_confirmation=a),type:y.value?"password":"text",label:"Konfirmasi password baru"},{append:o(()=>[l(h,{name:y.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[6]||(e[6]=a=>y.value=!y.value)},null,8,["name"])]),_:1},8,["modelValue","type"]),s("div",null,[l(d,{label:"Ubah",type:"submit",loading:r.value,color:"primary"},null,8,["loading"]),l(d,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=a=>g.value=a)},{default:o(()=>[l(C,{class:"q-pa-md",style:{"max-width":"400px"}},{default:o(()=>[l(R,{onSubmit:D,onReset:P,class:"q-gutter-md"},{default:o(()=>[l(v,{filled:"",modelValue:n.name,"onUpdate:modelValue":e[9]||(e[9]=a=>n.name=a),type:"text",label:"Nama"},null,8,["modelValue"]),l(v,{filled:"",modelValue:n.email,"onUpdate:modelValue":e[10]||(e[10]=a=>n.email=a),type:"email",label:"Email (opsional)"},null,8,["modelValue"]),s("div",null,[l(d,{label:"Ubah",type:"submit",loading:r.value,color:"primary"},null,8,["loading"]),l(d,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["user"])}}});export{ie as default};
