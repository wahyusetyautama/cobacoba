import{c as Ue,r as d,a as U,h as I,g as Ce,y as _e,R as Fe,O as ve,S as f,U as k,V as n,W as qe,an as Qe,a3 as b,X as a,Y as r,a8 as j,a2 as ue,H as F,$ as G,a0 as Se,a1 as pe,Z as N,_ as O,av as Re}from"./index.9dafe3c6.js";import{Q as je,a as De,b as be,c as J,d as Le,e as Pe}from"./QTable.a4ae34d9.js";import{Q as $e}from"./QToggle.94c87036.js";import{u as Ae,c as Ie,d as Ne,e as Oe,f as Te,g as Be,h as Ye,i as ye,j as He,a as D,b as T,Q as ge}from"./QCard.c4fa545a.js";import{Q as X,a as Z,d as Ve}from"./QCheckbox.05f27ddf.js";import{Q as B}from"./QDialog.4f4818b7.js";import{Q as ke,a as we,C as q}from"./ClosePopup.714dc5c1.js";import{u as Ke,c as Me,h as ze}from"./use-form.473e5b63.js";import{b as Ee,c as C,n as g}from"./function.626c708b.js";import{u as We}from"./use-meta.6e4b83a8.js";import{u as Ge}from"./storage.58af7870.js";import"./QItemSection.a12bf9c4.js";import"./QMarkupTable.36a1defc.js";import"./selection.248b0aec.js";import"./use-prevent-scroll.ab33211b.js";var Je=Ue({name:"QFile",inheritAttrs:!1,props:{...Ae,...Ke,...Ie,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ne,...Oe],setup(s,{slots:Y,emit:ee,attrs:V}){const{proxy:H}=Ce(),i=Te(),_=d(null),K=d(!1),w=Me(s),{pickFiles:Q,onDragover:oe,onDragleave:se,processFiles:ie,getDndNode:x}=Be({editable:i.editable,dnd:K,getFileInput:te,addFilesToQueue:ne}),P=Ye(s),u=U(()=>Object(s.modelValue)===s.modelValue?"length"in s.modelValue?Array.from(s.modelValue):[s.modelValue]:[]),M=U(()=>ye(u.value)),$=U(()=>u.value.map(o=>o.name).join(", ")),y=U(()=>ze(u.value.reduce((o,v)=>o+v.size,0))),re=U(()=>({totalSize:y.value,filesNumber:u.value.length,maxFiles:s.maxFiles})),ae=U(()=>({tabindex:-1,type:"file",title:"",accept:s.accept,capture:s.capture,name:w.value,...V,id:i.targetUid.value,disabled:i.editable.value!==!0})),S=U(()=>"q-file q-field--auto-height"+(K.value===!0?" q-file--dnd":"")),L=U(()=>s.multiple===!0&&s.append===!0);function c(o){const v=u.value.slice();v.splice(o,1),z(v)}function de(o){const v=u.value.findIndex(o);v>-1&&c(v)}function z(o){ee("update:modelValue",s.multiple===!0?o:o[0])}function le(o){o.keyCode===13&&_e(o)}function E(o){(o.keyCode===13||o.keyCode===32)&&Q(o)}function te(){return _.value}function ne(o,v){const p=ie(o,v,u.value,L.value),h=te();h!=null&&(h.value=""),p!==void 0&&((s.multiple===!0?s.modelValue&&p.every(fe=>u.value.includes(fe)):s.modelValue===p[0])||z(L.value===!0?u.value.concat(p):p))}function R(){return[I("input",{class:[s.inputClass,"q-file__filler"],style:s.inputStyle})]}function m(){if(Y.file!==void 0)return u.value.length===0?R():u.value.map((v,p)=>Y.file({index:p,file:v,ref:this}));if(Y.selected!==void 0)return u.value.length===0?R():Y.selected({files:u.value,ref:this});if(s.useChips===!0)return u.value.length===0?R():u.value.map((v,p)=>I(je,{key:"file-"+p,removable:i.editable.value,dense:!0,textColor:s.color,tabindex:s.tabindex,onRemove:()=>{c(p)}},()=>I("span",{class:"ellipsis",textContent:v.name})));const o=s.displayValue!==void 0?s.displayValue:$.value;return o.length>0?[I("div",{class:s.inputClass,style:s.inputStyle,textContent:o})]:R()}function me(){const o={ref:_,...ae.value,...P.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:ne};return s.multiple===!0&&(o.multiple=!0),I("input",o)}return Object.assign(i,{fieldClass:S,emitValue:z,hasValue:M,inputRef:_,innerValue:u,floatingLabel:U(()=>M.value===!0||ye(s.displayValue)),computedCounter:U(()=>{if(s.counterLabel!==void 0)return s.counterLabel(re.value);const o=s.maxFiles;return`${u.value.length}${o!==void 0?" / "+o:""} (${y.value})`}),getControlChild:()=>x("file"),getControl:()=>{const o={ref:i.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:s.tabindex};return i.editable.value===!0&&Object.assign(o,{onDragover:oe,onDragleave:se,onKeydown:le,onKeyup:E}),I("div",o,[me()].concat(m()))}}),Object.assign(H,{removeAtIndex:c,removeFile:de,getNativeElement:()=>_.value}),He(i)}});const Xe={class:"q-my-lg"},Ze={class:"q-pa-md"},ea=b("div",{class:"text-h6"},"Uraian Lembur",-1),aa={class:"row items-center justify-end"},la={key:0},ta=b("br",null,null,-1),na={key:0},ua={class:"row items-center justify-end"},oa={class:"row items-center justify-end"},sa={class:"row items-center justify-end"},ia={class:"row items-center justify-end"},ra=b("span",{class:"q-ml-sm"},"Anda yakin akan menghapus?",-1),da=b("span",{class:"q-ml-sm"},"Tindakan ini akan menghapus semua data dengan uraian kosong, lanjutkan?",-1),_a=Fe({__name:"AuthLembur",setup(s){We({title:"Lembur",titleTemplate:t=>`${t} - e-Umum 155`,meta:{description:{name:"description",content:"Uraian lembur aplikasi e Umum 155"},keywords:{name:"keywords",content:"Aplikasi e Umum 155"}}});const ee=qe(),V=Ge(),H=Ee(),i=d({}),_=d([]),K=d(null),w=d(!1);function Q(){w.value=!0,C.get("lemburs/index").then(t=>{V.lembur=t.data,_.value=V.lembur.datautama,w.value=!1}).catch(t=>{g(t.response.data)})}function oe(){C.get("user").then(t=>{V.user=t.data,i.value=V.user}).catch(t=>{g(t.response.data)})}function se(){C.get("waktu").then(t=>{K.value=t.data.waktu}).catch(t=>{g(t.response.data),H.localStorage.remove("auth"),V.$reset(),ee.push("/")})}H.localStorage.getItem("auth")?(se(),V.lembur?_.value=V.lembur.datautama:Q(),V.user?i.value=V.user:oe()):ee.push("/");const ie=[{name:"tanggal",align:"center",label:"Tanggal",field:"tanggal",sortable:!0},{name:"uraian",align:"center",label:"Uraian",field:"uraian",sortable:!0},{name:"user.name",align:"center",label:"Nama / NIP",field:"user.name"},{name:"jam_lembur",align:"center",label:"Jam Lembur",field:"jam_lembur"},{name:"RUH",align:"center",label:"RUH",field:"RUH"}],x=d(null),P=d(!0),u=d(!1);function M(t){return t<=Ve.formatDate(K.value,"YYYY/MM/DD")}const $=d(!1),y=ve({uraian:null,tanggal:null});function re(){u.value=!0,C.post("lemburs/store",y).then(t=>{$.value=!1,w.value=!0,g(t.data),ae(),Q(),u.value=!1}).catch(t=>{g(t.response.data),u.value=!1})}function ae(){y.uraian=null,y.tanggal=null}const S=d(null),L=d(!1),c=ve({uraian:null,tanggal:null});function de(t){L.value=!0,S.value=t.id,c.uraian=t.uraian,c.tanggal=t.tanggal}function z(){u.value=!0,C.patch("lemburs/"+S.value,c).then(t=>{L.value=!1,w.value=!0,g(t.data),le(),S.value=null,Q(),u.value=!1}).catch(t=>{g(t.response.data),u.value=!1})}function le(){c.uraian=null,c.tanggal=null}const E=d(!1);function te(t){S.value=t,E.value=!0}function ne(){C.delete("lemburs/"+S.value).then(t=>{w.value=!0,g(t.data),S.value=null,Q()}).catch(t=>{g(t.response.data)})}const R=d(!1),m=ve({dari:null,sampai:null});function me(){m.dari=null,m.sampai=null}function o(){u.value=!0,C.get("cektgl?dari="+m.dari+"&sampai="+m.sampai).then(()=>{C.get("lemburs/pdf?dari="+m.dari+"&sampai="+m.sampai,{responseType:"blob"}).then(t=>{const l=window.URL.createObjectURL(new Blob([t.data])),A=document.createElement("a");A.href=l,A.setAttribute("download","rekap_lembur.pdf"),document.body.appendChild(A),A.click(),u.value=!1}).catch(t=>{g(t.response.data),u.value=!1})}).catch(t=>{g(t.response.data),u.value=!1})}function v(){H.notify({progress:!0,message:"Gagal upload, pastikan kembali data dalam file sudah benar dan ekstensi file adalah xls/xlsx/xlsm",color:"red",icon:"cancel",position:"top-right"})}const p=d(!1),h=d(null);function fe(t){h.value=t.target.files[0]}function xe(){u.value=!0;let t=new FormData;t.append("excel",h.value),C.post("lemburs/excel",t).then(l=>{w.value=!0,g(l.data),Q(),h.value=null,u.value=!1,p.value=!1}).catch(()=>{v(),h.value=null,u.value=!1})}const ce=d(!1);function he(){u.value=!0,C.get("/lemburs/rapikan").then(t=>{w.value=!0,g(t.data),Q(),u.value=!1}).catch(t=>{g(t.response.data),u.value=!1})}return(t,l)=>{const A=Qe("auth-layout");return f(),k(A,{title:"Uraian Lembur",user:i.value},{default:n(()=>[b("div",Xe,[a(r,{class:"q-ml-sm",label:"Rekam",color:"primary",onClick:l[0]||(l[0]=e=>$.value=!0)}),a(r,{class:"q-ml-sm",label:"Print",color:"primary",onClick:l[1]||(l[1]=e=>R.value=!0)}),i.value.kew===1||i.value.kew===3?(f(),k(r,{key:0,class:"q-ml-sm",label:"Potensi",color:"primary",onClick:l[2]||(l[2]=e=>p.value=!0)})):j("",!0),i.value.kew===1||i.value.kew===3?(f(),k(r,{key:1,class:"q-ml-sm",label:"Rapikan",color:"primary",onClick:l[3]||(l[3]=e=>ce.value=!0)})):j("",!0),b("div",Ze,[a(Le,{title:"Uraian Lembur",loading:w.value,rows:_.value,columns:ie,"row-key":"tanggal",filter:x.value,separator:"cell"},{top:n(()=>[ea,a(De),a($e,{color:"blue",modelValue:P.value,"onUpdate:modelValue":l[4]||(l[4]=e=>P.value=e),"checked-icon":"description","unchecked-icon":"event",onClick:l[5]||(l[5]=e=>x.value=null)},null,8,["modelValue"]),P.value?(f(),k(D,{key:0,dense:"",debounce:"300",modelValue:x.value,"onUpdate:modelValue":l[6]||(l[6]=e=>x.value=e),placeholder:"Cari uraian"},{append:n(()=>[a(ue,{name:"search"})]),_:1},8,["modelValue"])):P.value?j("",!0):(f(),k(D,{key:1,readonly:"",dense:"",filled:"",modelValue:x.value,"onUpdate:modelValue":l[8]||(l[8]=e=>x.value=e),label:"Cari tanggal"},{default:n(()=>[a(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(Z,{modelValue:x.value,"onUpdate:modelValue":l[7]||(l[7]=e=>x.value=e),events:[..._.value.map(e=>e.tanggal)]},{default:n(()=>[b("div",aa,[F(a(r,{label:"OK",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue","events"])]),_:1})]),_:1},8,["modelValue"]))]),header:n(e=>[a(be,{props:e},{default:n(()=>[(f(!0),G(pe,null,Se(e.cols,W=>(f(),k(Pe,{key:W.name,props:e,class:"text-italic"},{default:n(()=>[N(O(W.label)+" ",1),W.sortable?(f(),k(ue,{key:0,name:"sort"})):j("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[a(be,{props:e},{default:n(()=>[a(J,{key:"tanggal",props:e},{default:n(()=>[N(O(Re(Ve).formatDate(e.row.tanggal,"dddd, DD MMMM YYYY")),1)]),_:2},1032,["props"]),a(J,{key:"uraian",props:e},{default:n(()=>[e.row.uraian===null?(f(),G("b",la,"Uraian lembur belum diisi")):(f(),G(pe,{key:1},[N(O(e.row.uraian),1)],64))]),_:2},1032,["props"]),a(J,{key:"user.name",props:e},{default:n(()=>[N(O(e.row.user.name)+" ",1),ta,N(" "+O(e.row.user.NIP),1)]),_:2},1032,["props"]),a(J,{key:"jam_lembur",props:e},{default:n(()=>[e.row.jam_lembur===null?(f(),G("b",na,"Potensi lembur belum tersedia")):(f(),G(pe,{key:1},[N(O(e.row.jam_lembur)+" jam ",1)],64))]),_:2},1032,["props"]),a(J,{key:"RUH",props:e},{default:n(()=>[i.value.id===e.row.user_id?(f(),k(r,{key:0,label:"Ubah",color:"primary",onClick:W=>de(e.row)},null,8,["onClick"])):j("",!0),i.value.id===e.row.user_id?(f(),k(r,{key:1,class:"q-ml-sm",label:"Hapus",color:"primary",onClick:W=>te(e.row.id)},null,8,["onClick"])):j("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["loading","rows","filter"])]),a(B,{modelValue:$.value,"onUpdate:modelValue":l[12]||(l[12]=e=>$.value=e)},{default:n(()=>[a(T,{class:"q-pa-md",style:{"max-width":"400px"}},{default:n(()=>[a(ge,{onSubmit:re,onReset:ae,class:"q-gutter-md"},{default:n(()=>[a(D,{filled:"",type:"text",modelValue:y.uraian,"onUpdate:modelValue":l[9]||(l[9]=e=>y.uraian=e),label:"Uraian"},null,8,["modelValue"]),a(D,{readonly:"",filled:"",modelValue:y.tanggal,"onUpdate:modelValue":l[11]||(l[11]=e=>y.tanggal=e),label:"Tanggal"},{default:n(()=>[a(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(Z,{modelValue:y.tanggal,"onUpdate:modelValue":l[10]||(l[10]=e=>y.tanggal=e),options:M},{default:n(()=>[b("div",ua,[F(a(r,{label:"OK",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),b("div",null,[a(r,{label:"Rekam",type:"submit",loading:u.value,color:"primary"},null,8,["loading"]),a(r,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:L.value,"onUpdate:modelValue":l[16]||(l[16]=e=>L.value=e)},{default:n(()=>[a(T,{class:"q-pa-md",style:{"max-width":"400px"}},{default:n(()=>[a(ge,{onSubmit:z,onReset:le,class:"q-gutter-md"},{default:n(()=>[a(D,{filled:"",type:"text",modelValue:c.uraian,"onUpdate:modelValue":l[13]||(l[13]=e=>c.uraian=e),label:"Uraian"},null,8,["modelValue"]),a(D,{readonly:"",filled:"",modelValue:c.tanggal,"onUpdate:modelValue":l[15]||(l[15]=e=>c.tanggal=e),label:"Tanggal"},{default:n(()=>[a(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(Z,{modelValue:c.tanggal,"onUpdate:modelValue":l[14]||(l[14]=e=>c.tanggal=e),options:M},{default:n(()=>[b("div",oa,[F(a(r,{label:"OK",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),b("div",null,[a(r,{label:"Ubah",type:"submit",loading:u.value,color:"primary"},null,8,["loading"]),a(r,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:R.value,"onUpdate:modelValue":l[21]||(l[21]=e=>R.value=e)},{default:n(()=>[a(T,{class:"q-pa-md",style:{"max-width":"400px"}},{default:n(()=>[a(ge,{onSubmit:o,onReset:me,class:"q-gutter-md"},{default:n(()=>[a(D,{readonly:"",filled:"",modelValue:m.dari,"onUpdate:modelValue":l[18]||(l[18]=e=>m.dari=e),label:"Dari"},{default:n(()=>[a(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(Z,{modelValue:m.dari,"onUpdate:modelValue":l[17]||(l[17]=e=>m.dari=e)},{default:n(()=>[b("div",sa,[F(a(r,{label:"OK",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(D,{readonly:"",filled:"",modelValue:m.sampai,"onUpdate:modelValue":l[20]||(l[20]=e=>m.sampai=e),label:"Sampai"},{default:n(()=>[a(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[a(Z,{modelValue:m.sampai,"onUpdate:modelValue":l[19]||(l[19]=e=>m.sampai=e)},{default:n(()=>[b("div",ia,[F(a(r,{label:"OK",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),b("div",null,[a(r,{label:"Print",type:"submit",loading:u.value,color:"primary"},null,8,["loading"]),a(r,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:E.value,"onUpdate:modelValue":l[23]||(l[23]=e=>E.value=e)},{default:n(()=>[a(T,null,{default:n(()=>[a(ke,{class:"row items-center"},{default:n(()=>[a(ue,{name:"info",color:"primary",size:"3em"}),ra]),_:1}),a(we,{align:"right"},{default:n(()=>[F(a(r,{flat:"",label:"Batal",color:"primary"},null,512),[[q]]),F(a(r,{flat:"",label:"Hapus",color:"negative",onClick:l[22]||(l[22]=e=>ne())},null,512),[[q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value.kew===1||i.value.kew===3?(f(),k(B,{key:2,modelValue:p.value,"onUpdate:modelValue":l[25]||(l[25]=e=>p.value=e)},{default:n(()=>[a(T,{class:"q-pa-md",style:{"max-width":"400px"}},{default:n(()=>[a(Je,{filled:"",modelValue:h.value,"onUpdate:modelValue":l[24]||(l[24]=e=>h.value=e),onChange:fe,label:"Upload (xls/xlsx/xlsm)",accept:".xlsx, .xls, .xlsm"},null,8,["modelValue"]),a(r,{label:"Upload Excel",onClick:xe,loading:u.value,color:"primary",class:"q-mt-md"},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])):j("",!0),i.value.kew===1||i.value.kew===3?(f(),k(B,{key:3,modelValue:ce.value,"onUpdate:modelValue":l[27]||(l[27]=e=>ce.value=e)},{default:n(()=>[a(T,null,{default:n(()=>[a(ke,{class:"row items-center"},{default:n(()=>[a(ue,{name:"info",color:"primary",size:"3em"}),da]),_:1}),a(we,{align:"right"},{default:n(()=>[F(a(r,{flat:"",label:"Batal",color:"primary"},null,512),[[q]]),F(a(r,{flat:"",label:"Hapus",color:"negative",onClick:l[26]||(l[26]=e=>he())},null,512),[[q]])]),_:1})]),_:1})]),_:1},8,["modelValue"])):j("",!0)])]),_:1},8,["user"])}}});export{_a as default};
